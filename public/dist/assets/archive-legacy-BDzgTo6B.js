System.register(["./index-legacy-B3b4o44M.js","./icon-legacy-Gm-LLu5s.js","./List-legacy-BAVX8rWV.js","./index-legacy-CjBVrUms.js","./File-legacy-DtUdK902.js","./Password-legacy-Be_YYY7o.js","./helper-legacy-CgyYofyx.js","./style-legacy-CzYVv4ZE.js","./Layout-legacy-Dmt3yrkD.js","./useTitle-legacy-iAEkztOM.js","./FolderTree-legacy-DlTzI1i6.js","./index-legacy-Cx4Ni-c9.js","./index-legacy-DsK2HFNK.js","./share-legacy-DCLtZ9QP.js","./index-legacy-CGQzr5j6.js","./storage-legacy-DkpoUQ7j.js"],function(e,r){"use strict";var t,n,l,a,i,c,o,s,u,d,g,h,p,w,m,f,b,j,y,_,$,x,k,v,C,O,P,S,z,F,U,A,M,E,I,L,R,q,J,N,B,H,T,X,D,G,Q,V,Y,K,W,Z,ee,re,te,ne,le,ae,ie,ce,oe,se;return{setters:[e=>{t=e.j,n=e.am,l=e.ba,a=e.eg,i=e.eh,c=e.P,o=e.B,s=e.C,u=e.a5,d=e.O,g=e.ei,h=e.D,p=e.a2,w=e.X,m=e.Y,f=e.ac,b=e.U,j=e.a1,y=e.S,_=e.a9,$=e.aa,x=e.ab,k=e.ah,v=e.o,C=e.ai,O=e.a8,P=e.aJ,S=e.ad,z=e.ax,F=e.bt,U=e.ap,A=e.dr,M=e.ej,E=e.bU,I=e.aN,L=e.aF,R=e.q,q=e.cE,J=e.cQ,N=e.a0,B=e.aw,H=e.bV,T=e.cH,X=e.aR,D=e.aX,G=e.a6,Q=e.a7,V=e._,Y=e.aU},e=>{K=e.O,W=e.g},e=>{Z=e.L,ee=e.c},e=>{re=e.d,te=e.g},e=>{ne=e.g,le=e.O},e=>{ae=e.default},e=>{ie=e.u},e=>{ce=e.b,oe=e.x,se=e.w},null,null,null,null,null,null,null,null],execute:function(){const r=e=>{const{show:r}=ce({id:2}),{isMouseSupported:t}=ie(),n=()=>R.list_item_filename_overflow;return h(B.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return h(z,{class:"list-item viselect-item",get"data-index"(){return e.index},w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",get _hover(){return{transform:"scale(1.01)",bgColor:N()}},get cursor(){return t()?"default":"pointer"},"on:click":r=>{e.obj.is_dir?e.jumpCallback():!e.obj.is_dir&&e.onFileClick&&e.onFileClick()},onContextMenu:t=>{r(t,{props:e})},get children(){return[h(z,{class:"name-box",spacing:"$1",get w(){return ee[0].w},get children(){return[h(I,{class:"icon",boxSize:"$6",get color(){return L()},get as(){return W(e.obj)},mr:"$1"}),h(k,{class:"name",get css(){return{wordBreak:"break-all",whiteSpace:"multi_line"===n()?"unset":"nowrap","overflow-x":"scrollable"===n()?"auto":"hidden",textOverflow:"ellipsis"===n()?"ellipsis":"unset","scrollbar-width":"none","&::-webkit-scrollbar":{display:"none"}}},get title(){return e.obj.name},get children(){return e.obj.name}})]}}),h(k,{class:"size",get w(){return ee[1].w},get textAlign(){return ee[1].textAlign},get children(){return q(e.obj.size)}}),h(k,{class:"modified",display:{"@initial":"none","@md":"inline"},get w(){return ee[2].w},get textAlign(){return ee[2].textAlign},get children(){return J(e.obj.modified)}})]}})}})},ue={extract:{icon:te,color:"$success9"},copy_link:{icon:re,color:"$info9"},download:{icon:Y,color:"$primary9"}},de=()=>{const{copy:e}=H(),{colorMode:r}=T(),{isShare:n}=t();return h(se,{id:2,animation:"scale",get theme(){return"dark"!==r()?"light":"dark"},style:"z-index: var(--hope-zIndices-popover)",get children(){return[h(oe,{hidden:({props:e})=>e.obj.is_dir,onClick:({props:e})=>{var r;r=e.url,window.open(r,"_blank")},get children(){return h(ge,{name:"download"})}}),h(oe,{hidden:({props:e})=>e.obj.is_dir,onClick:({props:r})=>{e(r.url)},get children(){return h(ge,{name:"copy_link"})}}),h(oe,{hidden:()=>{const e=D.findIndex(e=>"decompress"===e);return!n()&&!G.can(Q(),e)},onClick:({props:e})=>{X.emit("extract",JSON.stringify({inner:e.innerPath,pass:e.pass}))},get children(){return h(ge,{name:"extract"})}})]}})},ge=e=>{const r=v();return h(z,{spacing:"$2",get children(){return[h(I,{get p(){return ue[e.name].p?"$1":void 0},get as(){return ue[e.name].icon},boxSize:"$7",get color(){return ue[e.name].color}}),h(k,{get children(){return r(`home.toolbar.${e.name}`)}})]}})};e("default",()=>{const e=v(),{pathname:I}=t(),{rawLink:L}=n(),[R,q]=l(a),[J,N]=l(i),B=c(()=>R()||J());let H="",T="",X="",D=null;const[G,Q]=o(""),[Y,W]=o(!1),[ee,re]=o(!1),[te,ie]=o(""),[ce,oe]=o([]),[se,ue]=o(),[ge,he]=o(!1),[pe,we]=o(""),[me,fe]=o(""),[be,je]=o(""),ye=function(){let e=!1,r=[];return{acquire:()=>new Promise(t=>{e?r.push(t):(e=!0,t())}),release:()=>{r.length>0?r.shift()():e=!1}}}(),_e=e=>{let r={};return e.forEach(e=>{r[e.name]={...e,children:e.children?_e(e.children):null}}),r},$e=e=>200!==e.code&&(202===e.code?E(()=>{""!==H&&W(!0),re(!0),Q("")}):Q(e.message),!0),xe=async e=>{if(await ye.acquire(),ee()&&""===H)return ye.release(),[];if(""===T){const e=await q(I(),V(),H);if($e(e))return ye.release(),[];if(null!==e.data.content&&(D=_e(e.data.content)),T=e.data.raw_url,X=e.data.sign,ie(e.data.comment),void 0!==e.data.sort){let r;""!==e.data.sort.order_by&&(r=e.data.sort.order_by);let t="desc"===e.data.sort.order_direction,n=e.data.sort.extract_folder;E(()=>{ue(r),he(t),we(n)})}if(e.data.encrypted&&""===H)return E(()=>{re(!0),Q("")}),ye.release(),[]}if(null===D){const e=await N(I(),V(),H,"/");if($e(e))return ye.release(),[];D=_e(e.data.content)}let r=D;for(let t=0;t<e.length;t++){if(null===r[e[t]].children){const n=await N(I(),V(),H,"/"+e.slice(0,t+1).join("/"));if($e(n))return ye.release(),[];r[e[t]].children=_e(n.data.content)}r=r[e[t]].children}return E(()=>{re(!1),W(!1),Q("")}),ye.release(),Object.values(r)},[ke,ve]=o([]);s(()=>{xe(ce()).then(e=>ve(e))});const Ce=()=>{xe(ce()).then(e=>ve(e))};Ce();const Oe=()=>{let e=ke();se()&&(e=e.sort((e,r)=>(ge()?-1:1)*M(e[se()],r[se()])));let r=pe();if(""!==r){let t=[],n=[];e.forEach(e=>(e.is_dir?t:n).push(e)),e="front"===r?t.concat(n):n.concat(t)}return e},Pe=e=>{const r=ce().length>0?"/"+ce().join("/"):"";return{...e,sign:X,inner_path:r,archive:Ae}},Se=(e,r)=>{E(()=>{we(""),ue(e),void 0!==r&&he(r)})},ze=c(()=>Oe().filter(e=>!e.is_dir).map(e=>Pe(e))),Fe=c(()=>{const e=ze().find(e=>e.name===me());return e?ne({...e,provider:u.provider}):[]}),Ue=c(()=>{const e=Fe();if(0===e.length)return null;if(be()){const r=e.find(e=>e.name===be());if(r)return r}return e[0]}),Ae={...u.obj,inner_path:void 0,archive:void 0},Me=u.raw_url,Ee=e=>{E(()=>{if(""===e)g.setObj(Ae),g.setRawUrl(Me),fe("");else{const r=ze().find(r=>r.name===e);if(r){const t=L(r);g.setObj(r),g.setRawUrl(t),fe(e)}}})};return d(()=>{g.setObj(Ae),g.setRawUrl(Me)}),s(()=>{me(),je("")}),h(C,{spacing:"$2",w:"$full",get children(){return[h(p,{pl:"$2",pr:"$2",w:"$full",get children(){return[h(w,{get children(){return h(m,{get currentPage(){return f(()=>0===ce().length)()&&!me()},"on:click":()=>{oe([]),Ee("")},children:"."})}}),h(b,{get each(){return ce()},children:(e,r)=>h(w,{get children(){return[h(j,{}),h(m,{get currentPage(){return f(()=>ce().length===r()+1)()&&!me()},"on:click":()=>{oe(ce().slice(0,r()+1)),Ee("")},children:e})]}})}),h(y,{get when(){return me()},get children(){return h(w,{get children(){return[h(j,{}),h(m,{currentPage:!0,get children(){return me()}})]}})}})]}}),h(_,{get children(){return[h($,{get when(){return""!==G()},get children(){return h(x,{get msg(){return G()},disableColor:!0})}}),h($,{get when(){return ee()},get children(){return h(ae,{get title(){return e("home.toolbar.archive.input_password")},password:()=>H,setPassword:e=>H=e,enterCallback:()=>Ce(),get children(){return h(y,{get when(){return Y()},get children(){return h(k,{color:"$danger9",get children(){return e("home.toolbar.archive.incorrect_password")}})}})}})}}),h($,{get when(){return f(()=>!ee())()&&""===G()},get children(){return h(y,{get when(){return me()},get fallback(){return h(U,{get loading(){return B()},get children(){return h(C,{class:"list",w:"$full",spacing:"$1",get children(){return[h(Z,{sortCallback:Se,disableCheckbox:!0}),h(b,{get each(){return Oe()},children:(e,t)=>{const n=Pe(e);let l=e.is_dir?void 0:L(n),a=(i=e.name,(ce().length>0?"/"+ce().join("/"):"")+"/"+i);var i;return h(r,{obj:e,get index(){return t()},jumpCallback:()=>oe(ce().concat(e.name)),innerPath:a,url:l,pass:H,onFileClick:()=>Ee(e.name)})}}),h(de,{})]}})}})},get children(){return h(y,{get when(){return me()},get fallback(){return h(S,{})},get children(){return h(C,{w:"$full",spacing:"$2",alignItems:"center",get children(){return[h(y,{get when(){return Ue()},get children(){return h(O,{get fallback(){return h(S,{})},get children(){return h(P,{get component(){return Ue()?.component},get images(){return ze().filter(e=>e.type===K.IMAGE)},navigate:e=>{Ee(e)}})}})}}),h(z,{w:"$full",justifyContent:"center",spacing:"$2",p:"$2",get children(){return[h(y,{get when(){return Fe().length>1},get children(){return h(F,{get value(){return Ue()?.name||""},onChange:e=>je(String(e)),get options(){return Fe().map(e=>({value:e.name,label:e.name}))}})}}),h(le,{get file(){return{name:me(),raw_url:u.raw_url,d_url:u.raw_url}}})]}})]}})}})}})}})]}}),h(y,{get when(){return""!==te()},get children(){return[h(A,{}),h(k,{w:"$full",pl:"$1",pr:"$1",get children(){return te()}})]}})]}})})}}});
