System.register(["./index-legacy-B3b4o44M.js","./index-legacy-CjBVrUms.js"],function(e,r){"use strict";var t,n,o,l,a,u,c,g,i,d,s,h,p,f,C,b,w,m,$,v,y,k,x,F,S,I,z,P,O,_,E,j,T,V,H,K,M,R,B,D,J,N,L,W,A;return{setters:[e=>{t=e.aZ,n=e.D,o=e.I,l=e.o,a=e.S,u=e.K,c=e.ax,g=e.M,i=e.E,d=e.bv,s=e.F,h=e.G,p=e.J,f=e.L,C=e.B,b=e.dJ,w=e.ao,m=e.C,$=e.ac,v=e.bV,y=e.dK,k=e.ba,x=e.dN,F=e._,S=e.dL,I=e.ak,z=e.aN,P=e.aF,O=e.dM,_=e.ah,E=e.l,j=e.a0,T=e.ai,V=e.U,H=e.z,K=e.bu,M=e.bj,R=e.av,B=e.N,D=e.r,J=e.bc},e=>{N=e.o,L=e.E,W=e.J,A=e.K}],execute:function(){const r=b(),G=e("F",e=>{const[t,o]=C("/"),[l,a]=C(null);return e.handle?.({setPath:o,startCreateFolder:()=>{a(t())}}),n(w,{class:"folder-tree-box",w:"$full",overflowX:"auto",get children(){return n(r.Provider,{get value(){return{value:t,onChange:r=>{o(r),e.onChange(r)},autoOpen:e.autoOpen??!1,forceRoot:e.forceRoot??!1,showEmptyIcon:e.showEmptyIcon??!1,showHiddenFolder:e.showHiddenFolder??!0,creatingFolderPath:l,setCreatingFolderPath:a}},get children(){return n(U,{path:"/"})}})}})}),U=e=>{const{isHidePath:o}=v(),[l,u]=C(),{value:g,onChange:i,forceRoot:d,autoOpen:s,showEmptyIcon:h,showHiddenFolder:p,creatingFolderPath:f,setCreatingFolderPath:b}=y(r),[M,R]=k(()=>x(e.path,F(),d));let B=!1;const D=async(e=!1)=>{if(!e&&l()?.length)return;const r=await R();K(r,e=>{B=!0,u(e)},()=>{J()&&W()})},{isOpen:J,onToggle:W}=t(),A=()=>g()===e.path,G=S(e.path);return m(I(g,async e=>{s&&G(e)&&(J()||W(),B||D())})),m(()=>{f()===e.path&&(J()||W(),B||D())}),n(a,{get when(){return p||!(o(e.path)&&!G(g()))},get children(){return n(w,{get children(){return[n(c,{spacing:"$2",get children(){return[n(a,{get when(){return!M()},get fallback(){return n(O,{size:"sm",get color(){return P()}})},get children(){return n(a,{get when(){return!Boolean(h&&void 0!==l()&&!l()?.length)},get fallback(){return n(z,{get color(){return P()},as:L})},get children(){return n(z,{get color(){return P()},as:N,get transform(){return J()?"rotate(90deg)":"none"},transition:"transform 0.2s",cursor:"pointer",onClick:()=>{W(),J()&&D()}})}})}}),n(_,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return A()?"$info8":"transparent"},get _hover(){return{bgColor:A()?"$info8":j()}},onClick:()=>{i(e.path)},get children(){return $(()=>"/"===e.path)()?"root":E(e.path)}})]}}),n(a,{get when(){return J()},get children(){return n(T,{mt:"$1",pl:"$4",alignItems:"start",spacing:"$1",get children(){return[n(V,{get each(){return l()},children:r=>n(U,{get path(){return H(e.path,r.name)}})}),n(a,{get when(){return f()===e.path},get children(){return n(X,{get parentPath(){return e.path},onCancel:()=>b(null),onSuccess:e=>{b(null),i(e),D(!0)}})}})]}})}})]}})}})},X=e=>{const r=l(),[t,g]=C(""),[i,d]=k(M),s=async()=>{const n=t().trim();if(!n||i())return;const o=B(n);if(!o.valid)return void D.warning(r(`global.${o.error}`));const l=H(e.parentPath,n),a=await d(l);J(a,()=>{e.onSuccess(l)},()=>{e.onCancel()})};let h;return R(()=>{setTimeout(()=>{h?.focus(),h?.select()},0)}),n(c,{spacing:"$2",w:"$full",pl:"$4",alignItems:"center",get children(){return[n(z,{get color(){return P()},as:L}),n(o,{ref:e=>h=e,get value(){return t()},onInput:e=>g(e.currentTarget.value),get placeholder(){return r("home.toolbar.input_dir_name")},size:"sm",flex:"1",onKeyDown:r=>{"Enter"===r.key?(r.preventDefault(),s()):"Escape"===r.key&&e.onCancel()},onBlur:r=>{if(i())return;const n=r.relatedTarget;"true"!==n?.dataset.folderAction&&(t().trim()||e.onCancel())}}),n(a,{get when(){return!i()},get fallback(){return n(O,{size:"sm",get color(){return P()}})},get children(){return n(u,{get"aria-label"(){return r("global.ok")},size:"sm",variant:"ghost",rounded:"$md",p:"$1",color:"$success9",onClick:s,tabIndex:0,"data-folder-action":"true",get children(){return n(z,{as:W,boxSize:"$6"})}})}}),n(u,{get"aria-label"(){return r("global.cancel")},size:"sm",variant:"ghost",rounded:"$md",p:"$1",color:"$danger9",get onClick(){return e.onCancel},tabIndex:0,"data-folder-action":"true",get children(){return n(z,{as:A,boxSize:"$6"})}})]}})};e("M",e=>{const r=l(),[t,o]=C("/"),[d,b]=C();return m(()=>{e.opened&&d()?.setPath(t())}),"function"==typeof e.defaultValue?m(()=>{o(e.defaultValue())}):"string"==typeof e.defaultValue&&o(e.defaultValue),n(f,{size:"xl",blockScrollOnMount:!1,get opened(){return e.opened},get onClose(){return e.onClose},get children(){return[n(g,{}),n(i,{get children(){return[n(s,{w:"$full",css:{overflowWrap:"break-word"},get children(){return n(c,{w:"$full",justifyContent:"space-between",alignItems:"center",get children(){return[n(w,{css:{overflowWrap:"break-word"},get children(){return e.header}}),n(a,{get when(){return $(()=>!!e.headerSlot)()&&d()},get children(){return e.headerSlot(d())}})]}})}}),n(h,{get children(){return[$(()=>e.children),n(G,{onChange:o,handle:e=>b(e),autoOpen:!0})]}}),n(p,{display:"flex",w:"$full",gap:"$4",alignItems:"flex-end",justifyContent:"flex-end",get children(){return[n(a,{get when(){return e.footerSlot},get children(){return n(w,{mr:"auto",get children(){return e.footerSlot}})}}),n(c,{spacing:"$2",get children(){return[n(u,{get onClick(){return e.onClose},colorScheme:"neutral",get children(){return r("global.cancel")}}),n(u,{get loading(){return e.loading},onClick:()=>e.onSubmit?.(t()),get children(){return r("global.ok")}})]}})]}})]}})]}})}),e("a",e=>{const{isOpen:r,onOpen:C,onClose:b}=t(),w=l();return[n(c,{w:"$full",spacing:"$2",get children(){return[n(o,{get id(){return e.id},get value(){return e.value},onInput:r=>e.onChange(r.currentTarget.value),get readOnly(){return e.onlyFolder},get onClick(){return e.onlyFolder?C:()=>{}},get placeholder(){return w("global."+(e.onlyFolder?"choose_folder":"choose_or_input_path"))}}),n(a,{get when(){return!e.onlyFolder},get children(){return n(u,{onClick:C,get children(){return w("global.choose")}})}})]}}),n(f,{size:"xl",get opened(){return r()},onClose:b,get children(){return[n(g,{}),n(i,{get children(){return[n(d,{}),n(s,{get children(){return w("global.choose_folder")}}),n(h,{get children(){return n(G,{forceRoot:!0,get onChange(){return e.onChange}})}}),n(p,{get children(){return n(u,{onClick:b,get children(){return w("global.confirm")}})}})]}})]}})]})}}});
